$(document).ready(function() {
  $.ajax({
    type: "GET",
    url: 'https://docs.google.com/spreadsheets/d/1dVdFynrdxfACMgYRSZgB89-at-XxSjqqzMoHzcNrzow/gviz/tq?tqx=out:csv&sheet=Sheet1',
    dataType: "text",
    success: function(csvData) {
      // Populate dropdown menus
      var nameOptions = [];
      var artistOptions = [];
      data.features.forEach(function(feature) {
        nameOptions.push(feature.properties.Name);
        artistOptions.push(feature.properties.Artist);
      });

      var uniqueNameOptions = [...new Set(nameOptions)];
      var uniqueArtistOptions = [...new Set(artistOptions)];

      var nameSelect = document.getElementById('nameSelect');
      var artistSelect = document.getElementById('artistSelect');

      uniqueNameOptions.forEach(function(name) {
        var option = document.createElement('option');
        option.text = name;
        nameSelect.add(option);
      });

      uniqueArtistOptions.forEach(function(artist) {
        var option = document.createElement('option');
        option.text = artist;
        artistSelect.add(option);
      });

      // Call makeGeoJSON function to populate map points
      makeGeoJSON(csvData);
    }
  });

  function makeGeoJSON(csvData) {
    csv2geojson.csv2geojson(csvData, {
      latfield: 'Latitude',
      lonfield: 'Longitude',
      delimiter: ','
    }, function(err, data) {
      map.on('load', function() {
        map.addLayer({
          'id': 'csvData',
          'type': 'circle',
          'source': {
            'type': 'geojson',
            'data': data
          },
          'paint': {
            'circle-radius': 5,
            'circle-color': "#5154CC"
          }
        });

        // Event handlers for dropdown menus
        // ...
      });
    });
  }
});
